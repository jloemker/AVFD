# AVFD

## Single bin analysis and testing
1. The ```convert_tree_splitFiles.C``` converts text data generated by AVFD to root readable files. Excute this piece code by typing
```
aliroot convert_tree_splitFiles.C
```
2. After getting the root file, one can run the actual analysis work, which is included in the files:
```
Event.h Particle.h CalculateFlowCME.cxx CalculateFlowCME.h runSingleCentrality.C(centId, dirID,pTid,EtaID) testSingleCentrality.C(pTiD, etaID)
```
Event.h and Particle.h are two basic classes which store the information of particle tracks and should not be changed.
Inside runSingleCentrality.C, you have to specify the centrality bin that you want to analyze, the directory (baseline or CME contribution)and the pT and eta ranges. 
To run the analysis, one has to first compile ```CalculateFlowCME.cxx``` followed by compiling ```runSingleCentrality.C``` under aliroot environment. Use the runSingelCentraliy.C if your code works and you have a lot of time - the testSingleCentrality.C can be used for writing and testing your code (f.e. CalculateFlowCME.cxx).
Then, one has to put the right directory which stores the root data in this variable:
```
directory = Form("/dcache/alice/shiqiu/2020_AVFD_2.76TeV/Baseline/tree_Baseline_Cent%d_%d_%d.root", (centID)*5, (centID+1)*5, k);
```
First, one gets into aliroot environment by typing:
```
aliroot
```
Then, one types:
```
.x CalculateFlowCME.cxx++
.x runSingleCentrality.C++
```

## Full analysis
The current directories in the ```convert_tree_splitFile.C``` and ```runSingleCentrality.C``` are set to perform the whole analysis steps for the baseline and/or alpha = 0.1 (in batch mode) in the data directory.
One can specify the centrality bin(s) ```centID = {0: 0-5, 1: 5-10, 2: 10-20, 3: 20-30, 4: 30-40, 5: 40-50, 6: 50-60, 7: 60-70}``` and the samples ```dirID = {0: baseline, 1: a-0.1}``` within the the ```submit.sh``` and instead of the previous compiling steps the whole analysis can be run by typing:
```
source submit.sh
```
The new root fies are stored in ```result```, as specified in ```runSingleCentrality.C``` ,  and can be merged in the root environment via:
```
hadd outputfilename.root inputfiles
```
The output can then be analysed with the macro(s) in ```/plots```.

## Defining cuts and settings for the single and full analysis
Directories:
```
dirID = 0 for baseline
dirID = 1 for a-0.1
```
Int_t centID = 0; //0: 0-5%, 1: 5-10%, 2: 10-20%, 3: 20-30%, 4: 30-40%, 5: 40-50%, 6: 50-60%, 7: 60-70%
```
Choosing pT ranges:
pTmin = 0.2;
pTmax = 5.0;
if(pT == 1){pTmin = 0.2;pTmax = 0.7;}
if(pT == 2){pTmin = 1.0;pTmax = 2.0;}
if(pT == 3){pTmin = 1.0;pTmax = 3;}
if(pT == 4){pTmin = 1.8;pTmax = 2.5;}
if(pT == 5){pTmin = 0.2;pTmax = 3.0;}
```
Choosing eta ranges:
```
etaCut = 0.8;
if(eta==1){etaCut = 3.0;}
if(eta==2){etaCut = 2.0;}
```
